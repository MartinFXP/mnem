R code for loading and first preprocessing the Perturb-Seq data set(s) from K562 cells (Dixit et al., 2016).
  
		```r

library(data.table)

## data <- fread("data/perturbseq/k562_both_filt.txt")

## data.backup <- data

data <- data.backup

data <- data[, -1]

data <- as.matrix(data)

rownames(data) <- data.backup$GENE

## data.backup <- data

data <- data.backup

## data <- data[, grep("p7d", colnames(data))]

## data <- data[, grep("cc7d", colnames(data))]

## c2g <- read.csv("data/perturbseq/GSE90063_RAW/GSM2396858_k562_tfs_7_cbc_gbc_dict.csv", header = FALSE)

## c2g <- read.csv("data/perturbseq/GSE90063_RAW/GSM2396861_k562_ccycle_cbc_gbc_dict.csv", header = FALSE)

cn <- character(ncol(data))

for (i in 1:length(c2g[[1]])) {
    
    cells <- unlist(strsplit(as.character(c2g[[2]][[i]]), ", "))
    
    cn[which(colnames(data) %in% cells)] <- paste(cn[which(colnames(data) %in% cells)],
                                                       gsub("^c_|^c_sg|^m_|_[0-9]$|_10$", "", as.character(c2g[[1]][[i]])), sep = "_")

}

colnames(data) <- gsub("^_|^_p_sg|^_p_", "", cn)

## careful:

data <- data[, -which(colnames(data) %in% "")]

pertdist <- unlist(lapply(colnames(data), function(x) return(length(unlist(strsplit(x, "_"))))))

hist(pertdist)

if (length(grep("_", colnames(data))) > 0) {
    data <- data[, -grep("_", colnames(data))]
}

## save(data, file = "~/Mount/Grid/perturbseq_cc7d_data.rda")

## ##

load("~/Mount/Grid/perturbseq_p7d_data.rda")

```
